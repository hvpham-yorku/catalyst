<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>VA List Page</title>
    <!-- Link to Zephyr Theme CSS from CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.1.3/dist/zephyr/bootstrap.min.css">
    <style>
        /* Custom styles */
        .navbar-nav .nav-link {
            font-size: 1rem;
            opacity: 0.5; /* Set all links to 50% opacity */
        }

        .navbar-nav .nav-link.active {
            opacity: 1; /* Full opacity for the active link */
        }

        .navbar-brand {
            font-size: 2rem;
            padding-left: 20px;
            padding-right: 20px;
            color: white;
        }
    </style>
</head>
<body>
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary align-content-center">
    <div class="container-fluid">
        <h1 class="navbar-brand">Catalyst</h1> <!-- Company title -->
        <div class="collapse navbar-collapse" id="navbarColor01">
            <!-- Nav bar Items -->
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/">Home</a> <!-- Active link -->
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/patients">Patients</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/optometrists">Optometrists</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="/assessments">Assessments</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container mt-5">

    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h2 class="mb-4" style="margin: 0;">Visual Assessments</h2>
        <!-- Create button -->
        <button class="btn btn-success create-btn" data-bs-toggle="modal" data-bs-target="#createTemplate">Create</button>
    </div>


    <table class="table table-bordered table-striped">
        <thead class="table-header" style="background: #3459e6; color: white;">
        <tr>
            <th>Patient Name</th>
            <th>Doctor Name</th>
            <th>Assessment Date</th>
            <th>View More</th>
        </tr>
        </thead>
        <tbody>
        <tr> <!--- TODO: POPULATE WITH list  Visual assessments href --->
            <td>Jason Tran</td>
            <td>Kevin Nguyen</td>
            <td>2024-12-20</td>
            <td>
                <!--- TODO: Change href --->
                <!--- Make sure to move assessment-details.html to templates when everything setup --->
                <a th:href="@{/assessment-details.html}" class="btn btn-primary btn-sm">Expand</a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<!-- Modal for Create Visual Assessments -->
<div class="modal fade" id="expandTemplate" tabindex="-1" aria-labelledby="createTemplate" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Create Doctor</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div><!------ Select for Patient ----->
                    <label for="select-assessments-patients-field" class="form-label">Patient</label>
                    <select class="form-select" id="select-assessments-patients-field" th:each="patient : ${patients}">
                        <option value="" selected disabled>Please select a patient</option>
                        <option th:text="${patient.firstName + ' ' + patient.lastName + ': ID ' + patient.id}"></option>
                    </select>
                </div>
                <div><!------ Select for Doctor ----->
                    <label for="select-assessments-doctors-field" class="form-label mt-4">Doctor</label>
                    <select class="form-select" id="select-assessments-doctors-field">
                        <option value="" selected disabled>Please select a Doctor</option>
                        <option value=1212>Jason Tran: ID 1212</option> <!--- value wil consist of the patient's id ---->
                    </select>
                </div>
                <div><!------ Visual Acuity ----->
                    <label for="div-assessments-visualAcuity-field" class="form-label mt-4">Visual Acuity</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="div-assessments-visualAcuity-field">Left and Right</span>
                        </div>
                        <input type="number" class="form-control" id="input-assessments-leftVA-field" placeholder="Left Visual Acuity">
                        <input type="number" class="form-control" id="input-assessments-rightVA-field" placeholder="Right Visual Acuity">
                    </div>
                </div>
                <div><!------ Refraction ----->
                    <label for="div-assessments-refraction-field" class="form-label mt-4">Refraction</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="div-assessments-refraction-field">Left and Right</span>
                        </div>
                        <input type="number" class="form-control" id="input-assessments-leftRefraction-field" placeholder="Left Refraction">
                        <input type="number" class="form-control" id="input-assessments-rightRefraction-field" placeholder="Right Refraction">
                    </div>
                </div>
                <div><!------ Intraocular Pressure (mmHg) ----->
                    <label for="div-assessments-intraocularPressure-field" class="form-label mt-4">Intraocular Pressure (mmHg)</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="div-assessments-intraocularPressure-field">Left and Right</span>
                        </div>
                        <input type="number" class="form-control" id="input-assessments-leftIP-field" placeholder="Left Intraocular Pressure">
                        <input type="number" class="form-control" id="input-assessments-rightIP-field" placeholder="Right Intraocular Pressure">
                    </div>
                </div>
                <div><!------ Colour Vision ----->
                    <label for="select-colourVision-field" class="form-label mt-4">Colour Vision</label>
                    <select class="form-select" id="select-colourVision-field">
                        <option value="" selected disabled>Please select</option>
                        <option value="normal">Normal</option>
                        <option value="protanopia">Protanopia (Red Deficiency)</option>
                        <option value="deuteranopia">Deuteranopia (Green Deficiency)</option>
                        <option value="tritanopia">Tritanopia (Blue-Yellow Deficiency)</option>
                    </select>
                </div>
                <div><!------ Pupillary Response----->
                    <label for="select-pupillaryResponse-field" class="form-label mt-4">Pupillary Response</label>
                    <select class="form-select" id="select-pupillaryResponse-field">
                        <option value="" selected disabled>Please select</option>
                        <option value="normal">Normal</option>
                        <option value="sluggish">Sluggish</option>
                        <option value="non-reactive">Non-reactive</option>
                        <option value="delayed">Delayed</option>
                    </select>
                </div>
                <div><!------ Visual Field----->
                    <label for="select-visualField-field" class="form-label mt-4">Visual Field</label>
                    <select class="form-select" id="select-visualField-field">
                        <option value="" selected disabled>Please select</option>
                        <option value="normal">Normal</option>
                        <option value="central-loss">Central Loss</option>
                        <option value="peripheral-loss">Peripheral Loss</option>
                        <option value="quadrantanopia">Quadrantanopia</option>
                        <option value="hemianopia">Hemianopia</option>
                    </select>
                </div>
                <div> <!------ Assessment Date ----->
                    <label for="input-assessments-date-field" class="form-label mt-4">Assessment Date</label>
                    <input type="text" class="form-control" id="input-assessments-date-field" placeholder="YYYY/MM/DD">
                </div>
                <div><!------ Additional Notes ----->
                    <label for="textarea-assessments-date-field" class="form-label mt-4">Additional Notes</label>
                    <textarea class="form-control" id="textarea-assessments-date-field" rows="2"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <!------ Create Button for VA popup ----->
                <button type="button" class="btn btn-outline-success" id="button-optometrists-update">Update</button>
                <!------ Delete Button for VA popup ----->
                <button type="button" class="btn btn-outline-danger" id="button-optometrists-delete">Delete</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Create Visual Assessments -->
<div class="modal fade" id="createTemplate" tabindex="-1" aria-labelledby="createTemplate" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Create Doctor</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div><!------ Select for Patient ----->
                    <label for="select-assessments-patients" class="form-label">Patient</label>
                    <select class="form-select" id="select-assessments-patients"> <!--TODO ADD th:field-->
                        <option value="" selected disabled>Please select a patient</option>
                        <option th:each="patient : ${patients}"
                                th:value="${patient.id}"
                                th:text="${patient.firstName + ' ' + patient.lastName + ': ID ' + patient.id}"></option>
                    </select>
                </div>
                <div><!------ Select for Doctor ----->
                    <label for="select-assessments-doctors" class="form-label mt-4">Doctor</label>
                    <select class="form-select" id="select-assessments-doctors"> <!--TODO ADD th:field-->
                        <option value="" selected disabled>Please select a patient</option>
                        <option th:each="optometrist : ${optometrists}"
                                th:value="${optometrist.id}"
                                th:text="${optometrist.firstName + ' ' + optometrist.lastName + ': ID ' + optometrist.id}"></option>
                    </select>
                </div>
                <div><!------ Visual Acuity ----->
                    <label for="div-assessments-visualAcuity" class="form-label mt-4">Visual Acuity</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="div-assessments-visualAcuity">Left and Right</span>
                        </div>
                        <input type="number" class="form-control" id="input-assessments-leftVA" placeholder="Left Visual Acuity"> <!--TODO ADD th:field-->
                        <input type="number" class="form-control" id="input-assessments-rightVA" placeholder="Right Visual Acuity"> <!--TODO ADD th:field-->
                    </div>
                </div>
                <div><!------ Refraction ----->
                    <label for="div-assessments-refraction" class="form-label mt-4">Refraction</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="div-assessments-refraction">Left and Right</span>
                        </div>
                        <input type="number" class="form-control" id="input-assessments-leftRefraction" placeholder="Left Refraction"> <!--TODO ADD th:field-->
                        <input type="number" class="form-control" id="input-assessments-rightRefraction" placeholder="Right Refraction"> <!--TODO ADD th:field-->
                    </div>
                </div>
                <div><!------ Intraocular Pressure (mmHg) ----->
                    <label for="div-assessments-intraocularPressure" class="form-label mt-4">Intraocular Pressure (mmHg)</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="div-assessments-intraocularPressure">Left and Right</span>
                        </div>
                        <input type="number" class="form-control" id="input-assessments-leftIP" placeholder="Left Intraocular Pressure"> <!--TODO ADD th:field-->
                        <input type="number" class="form-control" id="input-assessments-rightIP" placeholder="Right Intraocular Pressure"> <!--TODO ADD th:field-->
                    </div>
                </div>
                <div><!------ Colour Vision ----->
                    <label for="select-colourVision" class="form-label mt-4">Colour Vision</label>
                    <select class="form-select" id="select-colourVision"> <!--TODO ADD th:field-->
                        <option value="" selected disabled>Please select</option>
                        <option value="normal">Normal</option>
                        <option value="protanopia">Protanopia (Red Deficiency)</option>
                        <option value="deuteranopia">Deuteranopia (Green Deficiency)</option>
                        <option value="tritanopia">Tritanopia (Blue-Yellow Deficiency)</option>
                    </select>
                </div>
                <div><!------ Pupillary Response----->
                    <label for="select-pupillaryResponse" class="form-label mt-4">Pupillary Response</label>
                    <select class="form-select" id="select-pupillaryResponse"> <!--TODO ADD th:field-->
                        <option value="" selected disabled>Please select</option>
                        <option value="normal">Normal</option>
                        <option value="sluggish">Sluggish</option>
                        <option value="non-reactive">Non-reactive</option>
                        <option value="delayed">Delayed</option>
                    </select>
                </div>
                <div><!------ Visual Field----->
                    <label for="select-visualField" class="form-label mt-4">Visual Field</label>
                    <select class="form-select" id="select-visualField"> <!--TODO ADD th:field-->
                        <option value="" selected disabled>Please select</option>
                        <option value="normal">Normal</option>
                        <option value="central-loss">Central Loss</option>
                        <option value="peripheral-loss">Peripheral Loss</option>
                        <option value="quadrantanopia">Quadrantanopia</option>
                        <option value="hemianopia">Hemianopia</option>
                    </select>
                </div>
                <div> <!------ Assessment Date ----->
                    <label for="input-assessments-date" class="form-label mt-4">Assessment Date</label>
                    <input type="text" class="form-control" id="input-assessments-date" placeholder="YYYY/MM/DD"> <!--TODO ADD th:field-->
                </div>
                <div><!------ Additional Notes ----->
                    <label for="textarea-assessments-date" class="form-label mt-4">Additional Notes</label>
                    <textarea class="form-control" id="textarea-assessments-date" rows="2"></textarea> <!--TODO ADD th:field-->
                </div>
            </div>
            <div class="modal-footer">
                <!------ Create Button for VA popup ----->
                <button type="button" class="btn btn-success" id="button-optometrists-create">Create</button>
            </div>
        </div>
    </div>
</div>


<script src="https://unpkg.com/imask"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {

        /* THIS IS FOR ASSESSMENT DATE MASKING */
        const dateOfBirthID = ["input-assessments-date", "input-assessments-date-field"];

        // Loop through each ID and apply the mask
        dateOfBirthID.forEach(id => {
            const inputElement = document.getElementById(id);
            if (inputElement) { // Check if the element exists
                IMask(inputElement, {
                    mask: Date,
                    pattern: 'YYYY/MM/DD',
                    lazy: true,
                    min: new Date(1970, 0, 1),
                    max: new Date(2030, 0, 1),

                    format: date => moment(date).format(momentFormat),
                    blocks: {
                        YYYY: {
                            mask: IMask.MaskedRange,
                            from: 1970,
                            to: 2030
                        },
                        MM: {
                            mask: IMask.MaskedRange,
                            from: 1,
                            to: 12
                        },
                        DD: {
                            mask: IMask.MaskedRange,
                            from: 1,
                            to: 31
                        },
                    }
                });
            }
        });
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>
